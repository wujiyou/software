var wsrProxy={port:0,baud:57600,proxy_ip:"127.0.0.1",proxy_port:35225,get_full:"",ret:-1,MSG_GETCARDNO:1024+1000,MODE_CARDTYPE:1,MODE_CARDSEQ:2,MODE_DATATYPE:3,MODE_TIMEOUT:4,MODE_COMMAND:5,MODE_MULTI_PORT:6,MODE_REQUEST:7,client_datatype:0,get_prefix:function(){return"http://"+this.proxy_ip+":"+this.proxy_port+"/wsr:"},init:function(){this.client_datatype=0;$.base64.utf8encode=true;jQuery.support.cors=true;$.ajaxSetup({async:false,cache:false,timeout:1000})},ws_getWsrJsInfo:function(obj){obj.version=0.19;obj.builddate=20190806;ret=1;return ret},ws_getDLLInfo:function(obj){ret=-1;this.get_full=this.get_prefix()+"ws_getDLLInfo"+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){obj.version=data.dll_version;obj.builddate=data.dll_builddate;ret=1});return ret},ws_getWsrProxyInfo:function(obj){ret=-1;this.get_full=this.get_prefix()+"ws_getWsrProxyInfo"+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){obj.version=data.proxy_version;obj.builddate=data.proxy_builddate;obj.isApp64=data.isApp64;ret=1});return ret},ws_setBaud:function(port,baud){ret=-1;this.get_full=this.get_prefix()+"ws_setBaud,"+port+","+baud+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_getBaud:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_getBaud,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.baud=data.baud});return ret},ws_openPort:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_openPort,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_closePort:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_closePort,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_callDevice:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_callDevice,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_callDeviceE:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_callDeviceE,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.model=data.dev_model;obj.cputype=data.dev_cputype;obj.version=data.dev_version});return ret},ws_beep:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_beep,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_beepex:function(port,delaytime){ret=-1;this.get_full=this.get_prefix()+"ws_beepex,"+port+","+delaytime+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_setNumber:function(port,number){ret=-1;this.get_full=this.get_prefix()+"ws_setNumber,"+port+","+number+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_get_dev_id:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_get_dev_id,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.id=data.dev_id});return ret},ws_get_dev_info:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_get_dev_info,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.info=data.dev_info});return ret},ws_reset:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_reset,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_set_device_mode:function(port,mode){ret=-1;this.get_full=this.get_prefix()+"ws_set_device_mode,"+port+","+mode+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_get_device_mode:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_get_device_mode,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.mode=data.mode});return ret},ws_set_device_default_mode:function(port,mode){ret=-1;this.get_full=this.get_prefix()+"ws_set_device_default_mode,"+port+","+mode+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_get_device_default_mode:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_get_device_default_mode,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.mode=data.mode});return ret},ws_displayText:function(port,lineno,length,text){ret=-1;this.get_full=this.get_prefix()+"ws_displayText,"+port+","+lineno+","+length+","+text+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_clearText:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_clearText,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_set_mode:function(mark_mode,mode){ret=-1;this.get_full=this.get_prefix()+"ws_set_mode,"+mark_mode+","+mode+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_get_mode:function(mark_mode,obj){ret=-1;this.get_full=this.get_prefix()+"ws_get_mode,"+mark_mode+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.mode=data.mode});return ret},ws_set_id_mode:function(port,mode){ret=-1;this.get_full=this.get_prefix()+"ws_set_id_mode,"+port+","+mode+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_get_id_mode:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_get_id_mode,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.mode=data.mode});return ret},ws_halt:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_halt,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_getCardNo_DWORD:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_getCardNo_DWORD,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.cardno=data.cardno>>>0});return ret},ws_getCardNo_Double:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_getCardNo_Double,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.cardno=data.cardno});return ret},ws_getCardNo_String:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_getCardNo_String,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.cardno=data.cardno});return ret},ws_getCardNo_Hex:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_getCardNo_Hex,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.cardno=data.cardno});return ret},ws_getCardNo_ex:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_getCardNo_ex,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.cardtype=data.cardtype;obj.cardbytes=data.cardbytes;obj.cardno=data.cardno});return ret},ws_loadKey:function(port,key,keytype){ret=-1;var tmpdata=this.toBase64(port+","+key+","+keytype);this.get_full=this.get_prefix()+"ws_loadKey,"+tmpdata+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_loadKeyE:function(port,key,keytype){ret=-1;var tmpdata=this.toBase64(port+","+key+","+keytype);this.get_full=this.get_prefix()+"ws_loadKeyE,"+tmpdata+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_verifyKey:function(port,key,keytype,sector){ret=-1;var tmpdata=this.toBase64(port+","+key+","+keytype+","+sector);this.get_full=this.get_prefix()+"ws_verifyKey,"+tmpdata+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_verifyKeyE:function(port,key,keytype,sector){ret=-1;var tmpdata=this.toBase64(port+","+key+","+keytype+","+sector);this.get_full=this.get_prefix()+"ws_verifyKeyE,"+tmpdata+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_changeKey:function(port,sector,newkeya,newac,newkeyb){ret=-1;var tmpdata=this.toBase64(port+","+sector+","+newkeya+","+newac+","+newkeyb);this.get_full=this.get_prefix()+"ws_changeKey,"+tmpdata+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_readBlock:function(port,block,obj){ret=-1;this.get_full=this.get_prefix()+"ws_readBlock,"+port+","+block+","+this.client_datatype+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.data=data.data});obj.data=this.fromBase64(obj.data);return ret},ws_writeBlock:function(port,block,data){ret=-1;var tmpdata=this.toBase64(data);this.get_full=this.get_prefix()+"ws_writeBlock,"+port+","+block+","+this.client_datatype+tmpdata+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_initValue:function(port,block,value){ret=-1;this.get_full=this.get_prefix()+"ws_initValue,"+port+","+block+","+value+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_readValue:function(port,block,obj){ret=-1;this.get_full=this.get_prefix()+"ws_readValue,"+port+","+block+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.value=data.value});return ret},ws_incValue:function(port,block,value){ret=-1;this.get_full=this.get_prefix()+"ws_incValue,"+port+","+block+","+value+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_decValue:function(port,block,value){ret=-1;this.get_full=this.get_prefix()+"ws_decValue,"+port+","+block+","+value+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_iso14443b_get_uid_2:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_iso14443b_get_uid_2,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.uid=data.uid;obj.len=data.len});return ret},ws_iso15693_setFlag:function(port,flag_select,flag_address,flag_tagType){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_setFlag,"+port+","+flag_select+","+flag_address+","+flag_tagType+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_iso15693_getFlag:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_getFlag,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.flag_select=data.flag_select;obj.flag_address=data.flag_address;obj.flag_tagType=data.flag_tagType});return ret},ws_iso15693_setUID:function(port,uid){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_setUID,"+port+","+uid+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_iso15693_getTags:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_getTags,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){obj.uids=data.uids;ret=data.rt});return ret},ws_iso15693_getTagInfo:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_getTagInfo,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){obj.uid=data.uid;obj.flag_memory=data.flag_memeory;obj.block_count=data.block_count;obj.block_size=data.block_size;ret=data.rt});return ret},ws_iso15693_getTagInfoE:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_getTagInfoE,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){obj.flag_dsfid=data.flag_dsfid;obj.flag_afi=data.flag_afi;obj.flag_memory=data.flag_memory;obj.flag_producer=data.flag_producer;obj.uid=data.uid;obj.dsfid=data.dsfid;obj.afi=data.afi;obj.block_count=data.block_count;obj.block_size=data.block_size;ret=data.rt});return ret},ws_iso15693_select:function(port,uid){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_select,"+port+","+uid+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_iso15693_reset:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_reset,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_iso15693_quiet:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_quiet,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_iso15693_readBlock:function(port,block,block_count,obj){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_readBlock,"+port+","+block+","+block_count+","+this.client_datatype+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.data=data.data});obj.data=this.fromBase64(obj.data);return ret},ws_iso15693_readBlockE:function(port,block,block_count,obj){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_readBlockE,"+port+","+block+","+block_count+","+this.client_datatype+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.data=data.data;obj.status=data.status});obj.data=this.fromBase64(obj.data);obj.status=this.fromBase64(obj.status);return ret},ws_iso15693_writeBlock:function(port,block,block_count,data){ret=-1;var tmpdata=this.toBase64(data);this.get_full=this.get_prefix()+"ws_iso15693_writeBlock,"+port+","+block+","+block_count+","+this.client_datatype+tmpdata+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_iso15693_lockBlock:function(port,block){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_lockBlock,"+port+","+block+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_iso15693_writeAFI:function(port,afi){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_writeAFI,"+port+","+afi+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_iso15693_lockAFI:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_lockAFI,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_iso15693_writeDSFID:function(port,dsfid){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_writeDSFID,"+port+","+dsfid+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_iso15693_lockDSFID:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_iso15693_lockDSFID,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_get_dev_usbcount:function(){ret=-1;this.get_full=this.get_prefix()+"ws_get_dev_usbcount,"+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_set_dev_usbindex:function(index){ret=-1;this.get_full=this.get_prefix()+"ws_set_dev_usbindex,"+index+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_get_dev_usbindex:function(){ret=-1;this.get_full=this.get_prefix()+"ws_get_dev_usbindex,"+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_monitor_begin:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_monitor_begin,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_monitor_end:function(){ret=-1;this.get_full=this.get_prefix()+"ws_monitor_end,"+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_monitor_getstatus:function(){ret=-1;this.get_full=this.get_prefix()+"ws_monitor_getstatus,"+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_monitor_setmessage:function(message){ret=-1;this.get_full=this.get_prefix()+"ws_monitor_setmessage,"+message+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_openScanner:function(port,baud,message){ret=-1;this.get_full=this.get_prefix()+"ws_openScanner,"+port+","+baud+","+message+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_closeScanner:function(port){ret=-1;this.get_full=this.get_prefix()+"ws_closeScanner,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt});return ret},ws_getBarcode:function(port,obj){ret=-1;this.get_full=this.get_prefix()+"ws_getBarcode,"+port+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){obj.barcode=data.barcode;if(data.rt<0){ret=data.rt}ret=data.rt});return ret},ws_sr_data:function(port,obj){var ret=-1;var tmpobj={mode:0};this.ws_get_mode(this.MODE_TIMEOUT,tmpobj);this.ws_set_mode(this.MODE_TIMEOUT,1000);var tmpdata=this.toBase64(obj.data);this.get_full=this.get_prefix()+"ws_sr_data,"+port+","+obj.len+","+tmpdata+","+(new Date()).getTime();$.getJSON(this.get_full,function(data){ret=data.rt;obj.len=data.len;obj.data=data.data});this.ws_set_mode(this.MODE_TIMEOUT,tmpobj.mode);return ret},getBytes:function(str){var byteSize=0,code=0;for(var i=0;i<str.length;i++){code=str.charCodeAt(i);if(code<=0xff)byteSize+=1;else byteSize+=2}return byteSize},getBytesStr:function(str,maxbytes){var byteSize=0,totalBytes=0;var tmpstr="";for(var i=0;i<str.length;i++){var code=str.charCodeAt(i);if(0x00<=code&&code<=0xff)byteSize=1;else byteSize=2;if((byteSize+totalBytes)>maxbytes)break;tmpstr+=str[i];totalBytes+=byteSize}return tmpstr},toBase64:function(str){var tmpstr=$.base64.encode(str,false);return tmpstr},fromBase64:function(str){var tmpstr=$.base64.decode(str,true);return tmpstr}};(function($){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a256='',r64=[256],r256=[256],i=0;var UTF8={encode:function(strUni){var strUtf=strUni.replace(/[\u0080-\u07ff]/g,function(c){var cc=c.charCodeAt(0);return String.fromCharCode(0xc0|cc>>6,0x80|cc&0x3f)}).replace(/[\u0800-\uffff]/g,function(c){var cc=c.charCodeAt(0);return String.fromCharCode(0xe0|cc>>12,0x80|cc>>6&0x3F,0x80|cc&0x3f)});return strUtf},decode:function(strUtf){var strUni=strUtf.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(c){var cc=((c.charCodeAt(0)&0x0f)<<12)|((c.charCodeAt(1)&0x3f)<<6)|(c.charCodeAt(2)&0x3f);return String.fromCharCode(cc)}).replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(c){var cc=(c.charCodeAt(0)&0x1f)<<6|c.charCodeAt(1)&0x3f;return String.fromCharCode(cc)});return strUni}};while(i<256){var c=String.fromCharCode(i);a256+=c;r256[i]=i;r64[i]=b64.indexOf(c);++i}function code(s,discard,alpha,beta,w1,w2){s=String(s);var buffer=0,i=0,length=s.length,result='',bitsInBuffer=0;while(i<length){var c=s.charCodeAt(i);c=c<256?alpha[c]:-1;buffer=(buffer<<w1)+c;bitsInBuffer+=w1;while(bitsInBuffer>=w2){bitsInBuffer-=w2;var tmp=buffer>>bitsInBuffer;result+=beta.charAt(tmp);buffer^=tmp<<bitsInBuffer}++i}if(!discard&&bitsInBuffer>0)result+=beta.charAt(buffer<<(w2-bitsInBuffer));return result}var Plugin=$.base64=function(dir,input,encode){return input?Plugin[dir](input,encode):dir?null:this};Plugin.btoa=Plugin.encode=function(plain,utf8encode){plain=Plugin.raw===false||Plugin.utf8encode||utf8encode?UTF8.encode(plain):plain;plain=code(plain,false,r256,b64,8,6);return plain+'===='.slice((plain.length%4)||4)};Plugin.atob=Plugin.decode=function(coded,utf8decode){coded=coded.replace(/[^A-Za-z0-9\+\/\=]/g,"");coded=String(coded).split('=');var i=coded.length;do{--i;coded[i]=code(coded[i],true,r64,a256,6,8)}while(i>0);coded=coded.join('');return Plugin.raw===false||Plugin.utf8decode||utf8decode?UTF8.decode(coded):coded}}(jQuery));

